# Changelog

## [v0.1.0] - 2025-12-12 (MVP)

Реализован полный пайплайн проверки фотографий на соответствие стандартам ICAO 9303.

### Функционал 
- **API Сервис:** Асинхронный REST API на базе **FastAPI** (`main.py`) с эндпоинтом `/validate` для интеграции с внешними системами РГБ.
- **Геометрический анализ:** Модуль `src/geometry.py` на базе **MediaPipe Face Mesh** (468 точек).
  - Расчет углов поворота головы (Yaw, Pitch, Roll) через итеративный алгоритм **PnP (Perspective-n-Point)**.
  - **Исправлена инверсия осей:** Реализована корректная нормализация углов Эйлера для устранения ошибок в диапазоне Pitch при работе с мобильными камерами.
  - Адаптация матрицы камеры для корректной работы с портретными снимками высокого разрешения.
- **Оценка качества (FIQA):** Модуль `src/quality.py` на базе архитектуры **MagFace (iResNet50)**.
  - Использование нативного **PyTorch** для сохранения точности вычислений (FP32).
  - Поддержка аппаратного ускорения на **Apple Silicon (MPS)** и стандартных CPU (x86/ARM).
  - Расчет интегральной оценки качества (Quality Score) на основе магнитуды вектора признаков.
- **Модуль тестирования:** Добавлен скрипт `test_metrics.py` для автоматизированного расчета метрик точности.

### Технические решения
- **Препроцессинг:**
  - Реализована автоматическая коррекция ориентации изображения на основе EXIF-метаданных (через `Pillow`).
  - Добавлена конвертация цветовых пространств и нормализация входных тензоров согласно требованиям MagFace.
- **Конфигурация:**
  - Все пороговые значения (углы, качество) вынесены в `src/config.py`.
  - Установлены откалиброванные пороги для условий естественного освещения: Yaw/Pitch (20°), Quality Score (7.0).
- **Валидация на данных:**
  - **Сформирован контрольный датасет:** Собрана выборка из 10 снимков (`data/test_samples`), включающая эталонные фото (Compliant) и типичные нарушения (Bad Angle, Low Quality, No Face).

### Документация
- Добавлен `README.md` с инструкцией по развертыванию, описанием архитектуры и результатами бенчмарков.
- Сформирован `requirements.txt` с фиксированными версиями библиотек для воспроизводимости среды.
- Проект опубликован под открытой лицензией MIT.